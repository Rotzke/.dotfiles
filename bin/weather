#!/bin/bash

/bin/ping -c 1 8.8.8.8 &> /dev/null

if [[ $? -eq 0 ]]
then
    if [ -f ~/.proxy.lock ]
    then
        echo -n ' ΔT = ' && echo -ne $YELLOW`curl -H 'Cache-Control: no-cache' -x socks://127.0.0.1:9050 -s 'https://api.darksky.net/forecast/f4b2b876511f01f53ff2c7c29d10f43e/48.4739,35.1527?units=si&exclude=minutely,hourly,daily,alerts,flags' | grep -oE 'apparentTemperature":[0-9\.-]+' | cut -d':' -f2` && echo -e '°'$NC
    elif [ ! -f ~/.proxy.lock ]
    then
        echo -n ' ΔT = ' && echo -ne $YELLOW`curl -H 'Cache-Control: no-cache' -s 'https://api.darksky.net/forecast/f4b2b876511f01f53ff2c7c29d10f43e/48.4739,35.1527?units=si&exclude=minutely,hourly,daily,alerts,flags' | grep -oE 'apparentTemperature":[0-9\.-]+' | cut -d':' -f2` && echo -e '°'$NC
    fi
else
    echo -e $RED"[OFFLINE MODE]: Temperature unavailable"$NC && exit 0
fi

